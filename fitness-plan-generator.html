<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fitness Plan Generator</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --primary:   #e74c3c;
      --primary-d: #c0392b;
      --accent:    #f39c12;
      --dark:      #1a1a2e;
      --card:      #16213e;
      --card2:     #0f3460;
      --text:      #ecf0f1;
      --muted:     #95a5a6;
      --radius:    12px;
    }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: var(--dark);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
    }

    /* ── Header ── */
    header {
      text-align: center;
      padding: 40px 20px 30px;
    }
    header .icon { font-size: 3rem; display: block; margin-bottom: 12px; }
    header h1 { font-size: clamp(1.8rem, 5vw, 2.8rem); font-weight: 800; letter-spacing: -0.5px; }
    header h1 span { color: var(--primary); }
    header p { color: var(--muted); margin-top: 8px; font-size: 1rem; }

    /* ── Layout ── */
    .container { max-width: 900px; margin: 0 auto; }

    /* ── Card ── */
    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 28px;
      margin-bottom: 24px;
      border: 1px solid rgba(255,255,255,0.06);
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .card h2 {
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--accent);
    }

    /* ── Form grid ── */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 18px;
    }
    .form-group { display: flex; flex-direction: column; gap: 6px; }
    .form-group.full { grid-column: 1 / -1; }

    label { font-size: 0.82rem; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; }

    input, select {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 8px;
      padding: 10px 14px;
      color: var(--text);
      font-size: 0.95rem;
      transition: border-color .2s, box-shadow .2s;
      outline: none;
      width: 100%;
    }
    input:focus, select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(231,76,60,.25);
    }
    select option { background: var(--card); }

    /* ── Checkboxes (equipment) ── */
    .equipment-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
      margin-top: 4px;
    }
    .eq-item {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 9px 12px;
      cursor: pointer;
      transition: background .2s, border-color .2s;
      user-select: none;
    }
    .eq-item:hover { background: rgba(231,76,60,.15); border-color: var(--primary); }
    .eq-item input[type="checkbox"] { accent-color: var(--primary); width: 16px; height: 16px; cursor: pointer; }
    .eq-item span { font-size: 0.88rem; }

    /* ── Generate button ── */
    .btn-generate {
      display: block;
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, var(--primary), var(--primary-d));
      color: #fff;
      border: none;
      border-radius: var(--radius);
      font-size: 1.05rem;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.5px;
      transition: opacity .2s, transform .15s;
      box-shadow: 0 4px 20px rgba(231,76,60,.4);
    }
    .btn-generate:hover { opacity: .92; transform: translateY(-1px); }
    .btn-generate:active { transform: translateY(0); }

    /* ── Output ── */
    #output { display: none; }

    .plan-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border-radius: var(--radius);
      padding: 28px;
      text-align: center;
      margin-bottom: 24px;
    }
    .plan-header h2 { font-size: 1.5rem; font-weight: 800; margin-bottom: 6px; }
    .plan-header p { font-size: 0.92rem; opacity: .85; }

    /* Stats row */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 14px;
      margin-bottom: 24px;
    }
    .stat-box {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.06);
    }
    .stat-box .val { font-size: 1.5rem; font-weight: 800; color: var(--accent); }
    .stat-box .lbl { font-size: 0.78rem; color: var(--muted); margin-top: 4px; text-transform: uppercase; letter-spacing: 0.5px; }

    /* Day cards */
    .week-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .day-card {
      background: var(--card);
      border-radius: var(--radius);
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.06);
    }
    .day-card .day-header {
      padding: 12px 16px;
      font-weight: 700;
      font-size: 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .day-card.rest .day-header  { background: rgba(149,165,166,.15); }
    .day-card.work .day-header  { background: rgba(231,76,60,.25); }
    .day-card.cardio .day-header{ background: rgba(52,152,219,.25); }

    .day-badge {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 20px;
      font-weight: 600;
    }
    .day-card.rest   .day-badge { background: rgba(149,165,166,.3); color: var(--muted); }
    .day-card.work   .day-badge { background: rgba(231,76,60,.4);   color: #ff8a80; }
    .day-card.cardio .day-badge { background: rgba(52,152,219,.4);  color: #81d4fa; }

    .exercise-list { padding: 14px 16px; list-style: none; }
    .exercise-list li {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 9px 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      font-size: 0.87rem;
      gap: 8px;
    }
    .exercise-list li:last-child { border-bottom: none; }
    .ex-name { font-weight: 500; }
    .ex-sets {
      font-size: 0.78rem;
      color: var(--accent);
      white-space: nowrap;
      font-weight: 600;
    }

    /* Tips */
    .tips-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 14px;
      margin-bottom: 24px;
    }
    .tip-box {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      border: 1px solid rgba(255,255,255,0.06);
      font-size: 0.87rem;
      line-height: 1.6;
    }
    .tip-box strong { display: block; margin-bottom: 6px; color: var(--accent); }

    /* Print / reset buttons */
    .action-row { display: flex; gap: 12px; flex-wrap: wrap; }
    .btn-action {
      flex: 1;
      min-width: 140px;
      padding: 13px;
      border-radius: 8px;
      font-size: 0.92rem;
      font-weight: 700;
      cursor: pointer;
      transition: opacity .2s;
      border: none;
    }
    .btn-print { background: var(--card2); color: var(--text); }
    .btn-reset { background: rgba(255,255,255,0.07); color: var(--text); }
    .btn-action:hover { opacity: .8; }

    @media print {
      body { background: #fff; color: #000; padding: 0; }
      .card, .day-card, .stat-box, .tip-box { background: #f9f9f9 !important; color: #000; border: 1px solid #ddd; }
      .btn-generate, .action-row { display: none; }
      #output { display: block !important; }
      header .icon { display: none; }
    }

    @media (max-width: 480px) {
      .card { padding: 18px; }
      .form-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<div class="container">

  <header>
    <span class="icon">&#127947;</span>
    <h1>Fitness Plan <span>Generator</span></h1>
    <p>Enter your details to receive a personalised weekly workout plan</p>
  </header>

  <!-- ── Input Form ── -->
  <div class="card">
    <h2>&#128100; Your Profile</h2>
    <div class="form-grid">

      <div class="form-group">
        <label for="age">Age (years)</label>
        <input type="number" id="age" min="13" max="90" placeholder="e.g. 28" />
      </div>

      <div class="form-group">
        <label for="gender">Gender</label>
        <select id="gender">
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="other">Other / Prefer not to say</option>
        </select>
      </div>

      <div class="form-group">
        <label for="weight">Weight (kg)</label>
        <input type="number" id="weight" min="30" max="300" placeholder="e.g. 75" />
      </div>

      <div class="form-group">
        <label for="height">Height (cm)</label>
        <input type="number" id="height" min="100" max="250" placeholder="e.g. 175" />
      </div>

      <div class="form-group">
        <label for="goal">Primary Goal</label>
        <select id="goal">
          <option value="lose">Lose Weight / Fat Loss</option>
          <option value="build">Build Muscle / Strength</option>
          <option value="endurance">Improve Endurance</option>
          <option value="tone">Tone &amp; Define</option>
          <option value="general">General Fitness</option>
        </select>
      </div>

      <div class="form-group">
        <label for="level">Fitness Level</label>
        <select id="level">
          <option value="beginner">Beginner (0-6 months)</option>
          <option value="intermediate">Intermediate (6m – 2yrs)</option>
          <option value="advanced">Advanced (2+ years)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="days">Workout Days / Week</label>
        <select id="days">
          <option value="3">3 days</option>
          <option value="4">4 days</option>
          <option value="5">5 days</option>
          <option value="6">6 days</option>
        </select>
      </div>

      <div class="form-group">
        <label for="duration">Session Length</label>
        <select id="duration">
          <option value="30">30 minutes</option>
          <option value="45">45 minutes</option>
          <option value="60" selected>60 minutes</option>
          <option value="90">90 minutes</option>
        </select>
      </div>

      <div class="form-group full">
        <label>Available Equipment</label>
        <div class="equipment-grid">
          <label class="eq-item"><input type="checkbox" name="eq" value="bodyweight" checked /><span>&#129354; Bodyweight</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="dumbbells" /><span>&#128170; Dumbbells</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="barbell" /><span>&#127947; Barbell</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="cables" /><span>&#128279; Cables / Machine</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="pullup" /><span>&#129360; Pull-up Bar</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="kettlebell" /><span>&#9899; Kettlebell</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="bands" /><span>&#129309; Resistance Bands</span></label>
          <label class="eq-item"><input type="checkbox" name="eq" value="cardio_machine" /><span>&#127939; Cardio Machine</span></label>
        </div>
      </div>

    </div>
  </div>

  <button class="btn-generate" onclick="generatePlan()">&#9889; Generate My Fitness Plan</button>

  <!-- ── Output ── -->
  <div id="output">

    <div class="plan-header">
      <h2 id="planTitle"></h2>
      <p id="planSubtitle"></p>
    </div>

    <div class="stats-row" id="statsRow"></div>

    <div class="card">
      <h2>&#128197; Weekly Schedule</h2>
      <div class="week-grid" id="weekGrid"></div>
    </div>

    <div class="card">
      <h2>&#128161; Nutrition &amp; Recovery Tips</h2>
      <div class="tips-grid" id="tipsGrid"></div>
    </div>

    <div class="card">
      <h2>&#128293; Actions</h2>
      <div class="action-row">
        <button class="btn-action btn-print" onclick="window.print()">&#128438; Print / Save as PDF</button>
        <button class="btn-action btn-reset" onclick="resetForm()">&#8635; Generate Another Plan</button>
      </div>
    </div>

  </div>

</div>

<script>
/* ============================================================
   Exercise Database
   ============================================================ */
const DB = {
  chest: {
    bodyweight: [
      { n:'Push-Ups',           s:'3x12-15' },
      { n:'Wide Push-Ups',      s:'3x10-12' },
      { n:'Diamond Push-Ups',   s:'3x8-12'  },
      { n:'Decline Push-Ups',   s:'3x10-12' },
    ],
    dumbbells: [
      { n:'Dumbbell Bench Press',  s:'4x10'    },
      { n:'Dumbbell Flyes',        s:'3x12'    },
      { n:'Incline DB Press',      s:'4x10'    },
    ],
    barbell: [
      { n:'Barbell Bench Press',   s:'4x8'     },
      { n:'Incline Barbell Press', s:'4x8'     },
    ],
    cables: [
      { n:'Cable Crossover',       s:'3x15'    },
      { n:'Chest Press Machine',   s:'3x12'    },
    ],
  },
  back: {
    bodyweight: [
      { n:'Superman Hold',         s:'3x12'    },
      { n:'Reverse Snow Angels',   s:'3x15'    },
    ],
    pullup: [
      { n:'Pull-Ups',              s:'4x6-10'  },
      { n:'Chin-Ups',              s:'3x8-10'  },
      { n:'Inverted Rows',         s:'3x12'    },
    ],
    dumbbells: [
      { n:'Dumbbell Row',          s:'4x10/side'},
      { n:'Bent-Over DB Row',      s:'3x12'    },
    ],
    barbell: [
      { n:'Barbell Row',           s:'4x8'     },
      { n:'Deadlift',              s:'4x5'     },
    ],
    cables: [
      { n:'Lat Pulldown',          s:'4x12'    },
      { n:'Seated Cable Row',      s:'3x12'    },
    ],
  },
  shoulders: {
    bodyweight: [
      { n:'Pike Push-Ups',         s:'3x10-12' },
      { n:'Wall Handstand Hold',   s:'3x20s'   },
    ],
    dumbbells: [
      { n:'Dumbbell OHP',          s:'4x10'    },
      { n:'Lateral Raises',        s:'3x15'    },
      { n:'Front Raises',          s:'3x12'    },
      { n:'Arnold Press',          s:'3x10'    },
    ],
    barbell: [
      { n:'Barbell OHP',           s:'4x8'     },
    ],
    cables: [
      { n:'Cable Lateral Raise',   s:'3x15'    },
      { n:'Face Pull',             s:'3x20'    },
    ],
  },
  arms: {
    bodyweight: [
      { n:'Tricep Dips',           s:'3x12-15' },
      { n:'Close-Grip Push-Ups',   s:'3x12'    },
    ],
    dumbbells: [
      { n:'Dumbbell Curl',         s:'3x12'    },
      { n:'Hammer Curl',           s:'3x12'    },
      { n:'Skull Crushers',        s:'3x12'    },
      { n:'Overhead Tricep Ext.',  s:'3x12'    },
    ],
    barbell: [
      { n:'Barbell Curl',          s:'3x10'    },
      { n:'Barbell Skull Crusher', s:'3x10'    },
    ],
    cables: [
      { n:'Cable Curl',            s:'3x15'    },
      { n:'Tricep Pushdown',       s:'3x15'    },
    ],
    bands: [
      { n:'Band Bicep Curl',       s:'3x15'    },
      { n:'Band Tricep Extension', s:'3x15'    },
    ],
  },
  legs: {
    bodyweight: [
      { n:'Bodyweight Squat',      s:'4x20'    },
      { n:'Lunges',                s:'3x12/leg'},
      { n:'Glute Bridges',         s:'3x20'    },
      { n:'Wall Sit',              s:'3x45s'   },
      { n:'Jump Squats',           s:'3x15'    },
    ],
    dumbbells: [
      { n:'Goblet Squat',          s:'4x12'    },
      { n:'DB Romanian Deadlift',  s:'3x12'    },
      { n:'DB Lunges',             s:'3x10/leg'},
    ],
    barbell: [
      { n:'Back Squat',            s:'4x8'     },
      { n:'Romanian Deadlift',     s:'4x10'    },
      { n:'Front Squat',           s:'3x8'     },
    ],
    cables: [
      { n:'Leg Press Machine',     s:'4x12'    },
      { n:'Leg Curl Machine',      s:'3x15'    },
      { n:'Leg Extension Machine', s:'3x15'    },
    ],
    kettlebell: [
      { n:'Kettlebell Swing',      s:'4x15'    },
      { n:'KB Goblet Squat',       s:'3x12'    },
    ],
  },
  core: {
    bodyweight: [
      { n:'Plank',                 s:'3x45s'   },
      { n:'Bicycle Crunches',      s:'3x20'    },
      { n:'Leg Raises',            s:'3x15'    },
      { n:'Mountain Climbers',     s:'3x30s'   },
      { n:'Russian Twists',        s:'3x20'    },
      { n:'Dead Bug',              s:'3x10/side'},
    ],
    cables: [
      { n:'Cable Crunch',          s:'3x15'    },
      { n:'Pallof Press',          s:'3x12/side'},
    ],
    bands: [
      { n:'Band Pallof Press',     s:'3x12'    },
    ],
  },
  cardio: {
    bodyweight: [
      { n:'Burpees',               s:'4x10'    },
      { n:'High Knees',            s:'3x45s'   },
      { n:'Jump Rope (shadow)',     s:'3x2min'  },
      { n:'Box Step-Ups',          s:'3x15'    },
    ],
    cardio_machine: [
      { n:'Treadmill Run / Walk',  s:'20-30min'},
      { n:'Stationary Bike',       s:'20-30min'},
      { n:'Rowing Machine',        s:'15-20min'},
      { n:'Elliptical Trainer',    s:'20-30min'},
    ],
  },
};

/* ============================================================
   Workout Templates: which muscle groups on which days
   ============================================================ */
const SPLITS = {
  3: [
    { label:'Full Body A', type:'work',   groups:['chest','back','legs','core'] },
    { label:'Full Body B', type:'work',   groups:['shoulders','arms','legs','core'] },
    { label:'Full Body C', type:'work',   groups:['chest','back','core'] },
    { label:'Rest',        type:'rest',   groups:[] },
  ],
  4: [
    { label:'Upper Body A',  type:'work',   groups:['chest','back','shoulders'] },
    { label:'Lower Body A',  type:'work',   groups:['legs','core'] },
    { label:'Upper Body B',  type:'work',   groups:['chest','shoulders','arms'] },
    { label:'Lower Body B',  type:'work',   groups:['legs','core'] },
    { label:'Rest',          type:'rest',   groups:[] },
  ],
  5: [
    { label:'Chest & Triceps',  type:'work',   groups:['chest','arms'] },
    { label:'Back & Biceps',    type:'work',   groups:['back','arms'] },
    { label:'Legs',             type:'work',   groups:['legs'] },
    { label:'Shoulders & Core', type:'work',   groups:['shoulders','core'] },
    { label:'Cardio & HIIT',    type:'cardio', groups:['cardio','core'] },
    { label:'Rest',             type:'rest',   groups:[] },
  ],
  6: [
    { label:'Chest',           type:'work',   groups:['chest','core'] },
    { label:'Back',            type:'work',   groups:['back'] },
    { label:'Legs',            type:'work',   groups:['legs'] },
    { label:'Shoulders',       type:'work',   groups:['shoulders','core'] },
    { label:'Arms',            type:'work',   groups:['arms'] },
    { label:'Cardio & HIIT',   type:'cardio', groups:['cardio'] },
    { label:'Rest',            type:'rest',   groups:[] },
  ],
};

const DAY_NAMES = ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'];

/* ============================================================
   Helpers
   ============================================================ */
function getEquipment() {
  return [...document.querySelectorAll('input[name="eq"]:checked')].map(c => c.value);
}

function pickExercises(group, equipment, n) {
  const pool = DB[group];
  if (!pool) return [];
  const list = [];
  const priority = ['barbell','dumbbells','kettlebell','cables','bands','pullup','cardio_machine','bodyweight'];
  for (const eq of priority) {
    if (equipment.includes(eq) && pool[eq]) list.push(...pool[eq]);
  }
  if (list.length === 0 && pool.bodyweight) list.push(...pool.bodyweight);
  // shuffle
  for (let i = list.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [list[i], list[j]] = [list[j], list[i]];
  }
  return list.slice(0, n);
}

function calcBMI(w, h) { return (w / ((h / 100) ** 2)).toFixed(1); }

function bmiCategory(bmi) {
  if (bmi < 18.5) return 'Underweight';
  if (bmi < 25)   return 'Healthy Weight';
  if (bmi < 30)   return 'Overweight';
  return 'Obese';
}

function calcTDEE(age, gender, weight, height, days) {
  // Mifflin-St Jeor BMR
  let bmr = gender === 'female'
    ? 10 * weight + 6.25 * height - 5 * age - 161
    : 10 * weight + 6.25 * height - 5 * age + 5;
  const multipliers = { 3: 1.375, 4: 1.55, 5: 1.725, 6: 1.9 };
  return Math.round(bmr * (multipliers[days] || 1.55));
}

function goalCalories(tdee, goal) {
  if (goal === 'lose')  return tdee - 400;
  if (goal === 'build') return tdee + 300;
  return tdee;
}

const GOAL_LABELS = {
  lose:     'Fat Loss',
  build:    'Muscle Building',
  endurance:'Endurance',
  tone:     'Tone & Define',
  general:  'General Fitness',
};
const LEVEL_LABELS = {
  beginner:     'Beginner',
  intermediate: 'Intermediate',
  advanced:     'Advanced',
};

/* ============================================================
   Exercises per group based on session duration
   ============================================================ */
function exPerGroup(duration) {
  if (duration <= 30) return 2;
  if (duration <= 45) return 3;
  if (duration <= 60) return 4;
  return 5;
}

/* ============================================================
   Nutrition Tips
   ============================================================ */
function getNutritionTips(goal, tdee, calories) {
  const protein = goal === 'build' ? '2.0–2.4g / kg bodyweight'
                : goal === 'lose'  ? '1.8–2.2g / kg bodyweight'
                :                   '1.6–2.0g / kg bodyweight';
  return [
    { icon:'&#127830;', title:'Daily Protein', text:`Aim for ${protein} to preserve and build lean muscle.` },
    { icon:'&#128167;', title:'Hydration',     text:'Drink at least 2.5–3L of water per day. More on training days.' },
    { icon:'&#9200;',   title:'Meal Timing',   text:'Eat a balanced meal 1-2 hours before and a protein-rich snack within 30 min after training.' },
    { icon:'&#128564;', title:'Sleep & Recovery', text:'Aim for 7-9 hours of sleep. Muscles grow during rest, not during the workout.' },
    {
      icon: goal === 'lose' ? '&#128293;' : '&#128154;',
      title: goal === 'lose' ? 'Calorie Deficit' : goal === 'build' ? 'Calorie Surplus' : 'Maintenance',
      text:  goal === 'lose'
               ? `Target ~${calories} kcal/day (${Math.abs(tdee - calories)} kcal deficit).`
               : goal === 'build'
               ? `Target ~${calories} kcal/day (${calories - tdee} kcal surplus).`
               : `Maintain ~${calories} kcal/day to fuel performance.`,
    },
    { icon:'&#129381;', title:'Progressive Overload', text:'Increase weight or reps every 1-2 weeks to keep making progress.' },
  ];
}

/* ============================================================
   Main Generator
   ============================================================ */
function generatePlan() {
  // ── Validate ──
  const age    = parseInt(document.getElementById('age').value);
  const weight = parseFloat(document.getElementById('weight').value);
  const height = parseFloat(document.getElementById('height').value);

  if (!age || !weight || !height) {
    alert('Please fill in your age, weight and height to generate a plan.');
    return;
  }

  const gender   = document.getElementById('gender').value;
  const goal     = document.getElementById('goal').value;
  const level    = document.getElementById('level').value;
  const days     = parseInt(document.getElementById('days').value);
  const duration = parseInt(document.getElementById('duration').value);
  const equipment= getEquipment();

  if (equipment.length === 0) {
    alert('Please select at least one equipment option (Bodyweight is free!).');
    return;
  }

  const bmi      = calcBMI(weight, height);
  const tdee     = calcTDEE(age, gender, weight, height, days);
  const calories = goalCalories(tdee, goal);
  const nEx      = exPerGroup(duration);

  // ── Titles ──
  document.getElementById('planTitle').textContent =
    `${GOAL_LABELS[goal]} Plan — ${LEVEL_LABELS[level]}`;
  document.getElementById('planSubtitle').textContent =
    `${days} training days/week · ${duration}-min sessions · Personalised for you`;

  // ── Stats ──
  const statsRow = document.getElementById('statsRow');
  statsRow.innerHTML = '';
  const stats = [
    { val: `${bmi}`, lbl: `BMI (${bmiCategory(bmi)})` },
    { val: `${tdee}`, lbl: 'Est. TDEE (kcal)' },
    { val: `${calories}`, lbl: goal === 'lose' ? 'Target Intake' : goal === 'build' ? 'Target Intake' : 'Maintenance' },
    { val: `${days}x`, lbl: 'Sessions / Week' },
    { val: `${duration}m`, lbl: 'Session Length' },
  ];
  stats.forEach(s => {
    statsRow.innerHTML += `<div class="stat-box"><div class="val">${s.val}</div><div class="lbl">${s.lbl}</div></div>`;
  });

  // ── Week Grid ──
  const weekGrid  = document.getElementById('weekGrid');
  weekGrid.innerHTML = '';
  const template  = SPLITS[days] || SPLITS[3];

  // Map template to 7 days
  const schedule = [];
  let t = 0;
  for (let d = 0; d < 7; d++) {
    if (t < template.length) {
      schedule.push({ day: DAY_NAMES[d], ...template[t] });
      t++;
    } else {
      schedule.push({ day: DAY_NAMES[d], label: 'Rest', type: 'rest', groups: [] });
    }
  }

  schedule.forEach(s => {
    const card = document.createElement('div');
    card.className = `day-card ${s.type}`;

    const badgeText = s.type === 'rest' ? 'Rest' : s.type === 'cardio' ? 'Cardio' : 'Training';
    card.innerHTML = `
      <div class="day-header">
        <span>${s.day} — ${s.label}</span>
        <span class="day-badge">${badgeText}</span>
      </div>`;

    if (s.type === 'rest') {
      card.innerHTML += `<ul class="exercise-list"><li><span class="ex-name" style="color:var(--muted)">Active recovery: light walk, stretching or yoga</span></li></ul>`;
    } else {
      let listHtml = '<ul class="exercise-list">';
      s.groups.forEach(grp => {
        const exercises = pickExercises(grp, equipment, nEx);
        exercises.forEach(ex => {
          listHtml += `<li><span class="ex-name">${ex.n}</span><span class="ex-sets">${ex.s}</span></li>`;
        });
      });
      listHtml += '</ul>';
      card.innerHTML += listHtml;
    }

    weekGrid.appendChild(card);
  });

  // ── Tips ──
  const tipsGrid = document.getElementById('tipsGrid');
  tipsGrid.innerHTML = '';
  getNutritionTips(goal, tdee, calories).forEach(t => {
    tipsGrid.innerHTML += `<div class="tip-box"><strong>${t.icon} ${t.title}</strong>${t.text}</div>`;
  });

  // ── Show output, scroll ──
  const out = document.getElementById('output');
  out.style.display = 'block';
  out.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function resetForm() {
  document.getElementById('output').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>

</body>
</html>
